////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Project name     : eCapture
// Client           : Energy Australia, via AEC Systems, Sydney
//
// File name        : AcceptErrorDlg.cpp
// Created          : 17th February 2011
// Created by       : S. Jaisimha
// Description      : Implementation for the "Accept Error" dialog
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#include "StdAfx.h"
#include "Resource.h"
#include "AcceptErrorDlg.h"


// CAcceptErrorDlg dialog
IMPLEMENT_DYNAMIC(CAcceptErrorDlg, CDialog)

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Function     : CAcceptErrorDlg::CAcceptErrorDlg
// Description  : Default constructor
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
CAcceptErrorDlg::CAcceptErrorDlg(CWnd* pParent /*=NULL*/)	: CDialog(CAcceptErrorDlg::IDD, pParent)
{
  m_bEditing = FALSE;
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Function     : CAcceptErrorDlg::!CAcceptErrorDlg
// Description  : Default destructor
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
CAcceptErrorDlg::~CAcceptErrorDlg()
{
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Function     : BEGIN_MESSAGE_MAP
// Description  : Message handlers
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
BEGIN_MESSAGE_MAP(CAcceptErrorDlg, CDialog)
  ON_BN_CLICKED(IDOK, &CAcceptErrorDlg::OnBnClickedOk)
END_MESSAGE_MAP()

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Function     : CAcceptErrorDlg::OnInitDialog
// Description  : Called before the dialog is displayed on screen
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
BOOL CAcceptErrorDlg::OnInitDialog()
{
  // Call the parent implementation
  CDialog::OnInitDialog();

  // Show the values
  SetDlgItemText(IDC_ACCEPT_ERRNO,   m_csErrNo);
  SetDlgItemText(IDC_ACCEPT_ERRTYPE, m_csErrType);
  SetDlgItemText(IDC_ACCEPT_REASON,  m_csErrReason);

  // Everything is OK
  return TRUE;
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Function     : CAcceptErrorDlg::OnBnClickedOk
// Description  : Called when the user clicks on the "OK" button
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void CAcceptErrorDlg::OnBnClickedOk()
{
  // Get the reason
  GetDlgItemText(IDC_ACCEPT_REASON, m_csErrReason);
  m_csErrReason.Trim();

  // Reason cannot be empty
  if (m_csErrReason.IsEmpty()) { ShowBalloon(_T("A reason must be specified."), this, IDC_ACCEPT_REASON); return; }

  // Close the dialog
  OnOK();
}
